



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://pages.charlesreid1.com/pod-charlesreid1/Service_gitea/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="..">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.3">
    
    
      
        <title>Pod Service: Gitea - pod-charlesreid1</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../css/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#gitea" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://pages.charlesreid1.com/pod-charlesreid1" title="pod-charlesreid1" class="md-header-nav__button md-logo">
          
            <i class="md-icon">dns</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                pod-charlesreid1
              </span>
              <span class="md-header-nav__topic">
                Pod Service: Gitea
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://git.charlesreid1.com/docker/pod-charlesreid1" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-charlesreid1
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://pages.charlesreid1.com/pod-charlesreid1" title="pod-charlesreid1" class="md-nav__button md-logo">
      
        <i class="md-icon">dns</i>
      
    </a>
    pod-charlesreid1
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://git.charlesreid1.com/docker/pod-charlesreid1" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-charlesreid1
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Index" class="md-nav__link">
      Index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_mediawiki/" title="Pod Service: MediaWiki" class="md-nav__link">
      Pod Service: MediaWiki
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_apachephp/" title="Pod Service: Apache/PHP" class="md-nav__link">
      Pod Service: Apache/PHP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_mysql/" title="Pod Service: MySQL" class="md-nav__link">
      Pod Service: MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_phpmyadmin/" title="Pod Service: phpMyAdmin" class="md-nav__link">
      Pod Service: phpMyAdmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_nginx/" title="Pod Service: nginx" class="md-nav__link">
      Pod Service: nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Service_pythonfiles/" title="Pod Service: Python File Server" class="md-nav__link">
      Pod Service: Python File Server
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Pod Service: Gitea
      </label>
    
    <a href="./" title="Pod Service: Gitea" class="md-nav__link md-nav__link--active">
      Pod Service: Gitea
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-docker-container" title="Configuring Docker Container" class="md-nav__link">
    Configuring Docker Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-volumes" title="Gitea Volumes" class="md-nav__link">
    Gitea Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-ports" title="Gitea Ports" class="md-nav__link">
    Gitea Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-configuration-files" title="Gitea Configuration Files" class="md-nav__link">
    Gitea Configuration Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backing-up-gitea" title="Backing Up Gitea" class="md-nav__link">
    Backing Up Gitea
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restoring-gitea" title="Restoring Gitea" class="md-nav__link">
    Restoring Gitea
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Running/" title="Running the Pod" class="md-nav__link">
      Running the Pod
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Volumes/" title="Volumes" class="md-nav__link">
      Volumes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Backups/" title="Backups" class="md-nav__link">
      Backups
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Ports/" title="Domains and Ports" class="md-nav__link">
      Domains and Ports
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Secrets/" title="Secrets" class="md-nav__link">
      Secrets
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuring-docker-container" title="Configuring Docker Container" class="md-nav__link">
    Configuring Docker Container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-volumes" title="Gitea Volumes" class="md-nav__link">
    Gitea Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-ports" title="Gitea Ports" class="md-nav__link">
    Gitea Ports
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gitea-configuration-files" title="Gitea Configuration Files" class="md-nav__link">
    Gitea Configuration Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backing-up-gitea" title="Backing Up Gitea" class="md-nav__link">
    Backing Up Gitea
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restoring-gitea" title="Restoring Gitea" class="md-nav__link">
    Restoring Gitea
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="gitea">Gitea<a class="headerlink" href="#gitea" title="Permanent link">&para;</a></h1>
<p>Gitea is a self-hosted Github clone. It is written in Go, and 
provides a web interface and an API to interact with an instance
of a git server.</p>
<p>Gitea manages its own database, so to get data in and out of
Gitea, use its dump and load functionality (more below).</p>
<p>This page describes how the Gitea container is configured.</p>
<h2 id="configuring-docker-container">Configuring Docker Container<a class="headerlink" href="#configuring-docker-container" title="Permanent link">&para;</a></h2>
<p>To run gitea, we use a stock Gitea container image. We set
several options in the docker configuration:</p>
<ul>
<li>
<p><code>USER_UID</code> and <code>USER_GID</code> are set to <code>1000</code> (this avoids some
  problems with files that would otherwise be owned by root)</p>
</li>
<li>
<p>Set <code>restart: always</code> to restart the container when there
  is a failure</p>
</li>
</ul>
<div class="codehilite"><pre><span></span>  stormy_gitea:
    image: gitea/gitea:latest
    environment:
      - USER_UID=1000
      - USER_GID=1000
    restart: always
</pre></div>


<h2 id="gitea-volumes">Gitea Volumes<a class="headerlink" href="#gitea-volumes" title="Permanent link">&para;</a></h2>
<p>The Gitea container stores all of its data in <code>/data/</code> inside
the container.</p>
<p>When the container is launched, the <code>custom/</code> directory in
the <a href="https://git.charlesreid1.com/docker/d-gitea">docker/d-gitea</a>
repository is mounted to <code>/data/gitea/</code>, which is the directory
that contains the files that are used to control the way that
Gitea pages look. These contain HTML templates used to render
different views in Gitea and templates in <code>custom/</code> will override
the default Gitea page templates.</p>
<p>A docker volume named <code>stormy_gitea_data</code> is also created and 
mounted at <code>/data/</code>. This is a persistent volume that will 
survive even if the container is shut down.</p>
<div class="codehilite"><pre><span></span>    volumes:
      - &quot;stormy_gitea_data:/data&quot;
      - &quot;./d-gitea/custom/conf/app.ini:/data/gitea/conf/app.ini&quot;
      - &quot;./d-gitea/custom/public:/data/gitea/public&quot;
      - &quot;./d-gitea/custom/templates:/data/gitea/templates&quot;
</pre></div>


<h2 id="gitea-ports">Gitea Ports<a class="headerlink" href="#gitea-ports" title="Permanent link">&para;</a></h2>
<p>Gitea provides both SSH and HTTPS interfaces, as it has its own
built-in web server and SSH server, as well as git server.</p>
<p>The server that is hosting the Gitea container and this Docker
pod already has an SSH server listening on port 22, so Gitea
listens for SSH connections <em>externally</em> on port 222.</p>
<div class="codehilite"><pre><span></span>    ports:
      - &quot;222:22&quot;
</pre></div>


<p>Note that this <em>bypasses</em> our d-nginx-charlesreid1 nginx container
entirely and allows clients to connect to Gitea directly.</p>
<p>The Gitea server listens for HTTP/HTTPS connections on port
3000, but that is by default only listening on the internal
Docker network, which is exactly how we want it. We want all
HTTP and HTTPS traffic to be handled by the front-end d-nginx-charlesreid1
container, and it will reverse-proxy HTTP/HTTPS requests to 
the Gitea container.</p>
<h2 id="gitea-configuration-files">Gitea Configuration Files<a class="headerlink" href="#gitea-configuration-files" title="Permanent link">&para;</a></h2>
<p><code>app.ini</code> is the name of the configuration file used by Gitea.
An <a href="https://git.charlesreid1.com/docker/d-gitea/src/branch/master/app.ini.sample">example <code>app.ini</code> configuration file</a> 
is contained in the <a href="https://git.charlesreid1.com/docker/d-gitea">docker/d-gitea</a>
repository, as well as a script to
<a href="https://git.charlesreid1.com/docker/d-gitea/src/branch/master/make_app_ini.sh">make a configuration file</a>.</p>
<div class="codehilite"><pre><span></span>    volumes:
      - &quot;stormy_gitea_data:/data&quot;
      - &quot;./d-gitea/custom/conf/app.ini:/data/gitea/conf/app.ini&quot;
</pre></div>


<h2 id="backups">Backups<a class="headerlink" href="#backups" title="Permanent link">&para;</a></h2>
<h3 id="backing-up-gitea">Backing Up Gitea<a class="headerlink" href="#backing-up-gitea" title="Permanent link">&para;</a></h3>
<h3 id="restoring-gitea">Restoring Gitea<a class="headerlink" href="#restoring-gitea" title="Permanent link">&para;</a></h3>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Service_pythonfiles/" title="Pod Service: Python File Server" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Pod Service: Python File Server
              </span>
            </div>
          </a>
        
        
          <a href="../Running/" title="Running the Pod" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Running the Pod
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 <a href="https://charlesreid1.com">Charles Reid</a>, released under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.e72fd936.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../search/main.js"></script>
      
    
    
      
    
  </body>
</html>