



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://pages.charlesreid1.com/pod-charlesreid1/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href=".">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.3">
    
    
      
        <title>pod-charlesreid1</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="css/custom.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pod-charlesreid1" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://pages.charlesreid1.com/pod-charlesreid1" title="pod-charlesreid1" class="md-header-nav__button md-logo">
          
            <i class="md-icon">dns</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                pod-charlesreid1
              </span>
              <span class="md-header-nav__topic">
                Index
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://git.charlesreid1.com/docker/pod-charlesreid1" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-charlesreid1
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://pages.charlesreid1.com/pod-charlesreid1" title="pod-charlesreid1" class="md-nav__button md-logo">
      
        <i class="md-icon">dns</i>
      
    </a>
    pod-charlesreid1
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://git.charlesreid1.com/docker/pod-charlesreid1" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      pod-charlesreid1
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Index
      </label>
    
    <a href="." title="Index" class="md-nav__link md-nav__link--active">
      Index
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#services" title="Services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" title="Links" class="md-nav__link">
    Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" title="Quick Start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running" title="Running" class="md-nav__link">
    Running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" title="Volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domains-and-ports" title="Domains and Ports" class="md-nav__link">
    Domains and Ports
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-port-info" title="Additional Port Info" class="md-nav__link">
    Additional Port Info
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets" title="Secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-specific-configuration-details" title="Container-Specific Configuration Details" class="md-nav__link">
    Container-Specific Configuration Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links_1" title="Links" class="md-nav__link">
    Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="Service_mediawiki/" title="Pod Service: MediaWiki" class="md-nav__link">
      Pod Service: MediaWiki
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_apachephp/" title="Pod Service: Apache/PHP" class="md-nav__link">
      Pod Service: Apache/PHP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_mysql/" title="Pod Service: MySQL" class="md-nav__link">
      Pod Service: MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_phpmyadmin/" title="Pod Service: phpMyAdmin" class="md-nav__link">
      Pod Service: phpMyAdmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_nginx/" title="Pod Service: nginx" class="md-nav__link">
      Pod Service: nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_pythonfiles/" title="Pod Service: Python File Server" class="md-nav__link">
      Pod Service: Python File Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="Service_gitea/" title="Pod Service: Gitea" class="md-nav__link">
      Pod Service: Gitea
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Running/" title="Running the Pod" class="md-nav__link">
      Running the Pod
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Volumes/" title="Volumes" class="md-nav__link">
      Volumes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Backups/" title="Backups" class="md-nav__link">
      Backups
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Ports/" title="Domains and Ports" class="md-nav__link">
      Domains and Ports
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="Secrets/" title="Secrets" class="md-nav__link">
      Secrets
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#services" title="Services" class="md-nav__link">
    Services
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" title="Links" class="md-nav__link">
    Links
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" title="Quick Start" class="md-nav__link">
    Quick Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running" title="Running" class="md-nav__link">
    Running
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#volumes" title="Volumes" class="md-nav__link">
    Volumes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backups" title="Backups" class="md-nav__link">
    Backups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#domains-and-ports" title="Domains and Ports" class="md-nav__link">
    Domains and Ports
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-port-info" title="Additional Port Info" class="md-nav__link">
    Additional Port Info
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets" title="Secrets" class="md-nav__link">
    Secrets
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-specific-configuration-details" title="Container-Specific Configuration Details" class="md-nav__link">
    Container-Specific Configuration Details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links_1" title="Links" class="md-nav__link">
    Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="pod-charlesreid1">pod-charlesreid1<a class="headerlink" href="#pod-charlesreid1" title="Permanent link">&para;</a></h1>
<p>This repo contains a docker compose file 
for running the charlesreid1.com site.</p>
<h2 id="services">Services<a class="headerlink" href="#services" title="Permanent link">&para;</a></h2>
<p>The services available through pod-charlesreid1 are:</p>
<ul>
<li><a href="Service_mediawiki/">mediawiki</a></li>
<li><a href="Service_apachephp/">apache + php</a></li>
<li><a href="Service_mysql/">mysql</a></li>
<li><a href="Service_phpmyadmin/">phpmyadmin</a></li>
<li><a href="Service_nginx/">nginx + ssl</a></li>
<li><a href="Service_pythonfiles/">python</a> (in progress)</li>
<li><a href="Service_gitea/">gitea</a> (in progress)</li>
</ul>
<h2 id="links">Links<a class="headerlink" href="#links" title="Permanent link">&para;</a></h2>
<p>See the documentation site here: <a href="https://pages.charlesreid1.com/pod-charlesreid1">https://pages.charlesreid1.com/pod-charlesreid1</a></p>
<p>Or visit docs/index.md`.</p>
<p>Source code on git.charlesreid1.com: <a href="https://git.charlesreid1.com/docker/pod-charlesreid1">https://git.charlesreid1.com/docker/pod-charlesreid1</a></p>
<p>Source code on github.com: <a href="https://github.com/charlesreid1-docker/pod-charlesreid1">https://github.com/charlesreid1-docker/pod-charlesreid1</a></p>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<p>From your project directory, start up the pod:</p>
<div class="codehilite"><pre><span></span>$ docker-compose up
</pre></div>


<p>If you want to rebuild the images before starting them
(i.e., if you changed the Dockerfile and want to rebuild the
Docker image), use the <code>--build</code> flag:</p>
<div class="codehilite"><pre><span></span>$ docker-compose up --build
</pre></div>


<p>If you only want to rebuild the images without starting the
Docker pod, use the build verb:</p>
<div class="codehilite"><pre><span></span>$ docker-compose build
</pre></div>


<p>And finally, if you want to rebuild every container from scratch,
rather than using cached data (note that this may take a while),
add the <code>--no-cache</code> flag:</p>
<div class="codehilite"><pre><span></span>$ docker-compose build --no-cache
</pre></div>


<h2 id="running">Running<a class="headerlink" href="#running" title="Permanent link">&para;</a></h2>
<p>See <strong><a href="Running/">Running.md</a></strong> for info about running this docker pod:</p>
<ul>
<li>Running the Docker Pod from Comand Line</li>
<li>Running the Docker Pod as a Startup Service</li>
<li>Workflow for Charlesreid1 Docker Pod Updates</li>
<li>Restoring the Docker Pod from Backups</li>
</ul>
<h2 id="volumes">Volumes<a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h2>
<p>See <strong><a href="Volumes/">Volumes.md</a></strong> for info about data and volumes 
used by this docker pod:</p>
<ul>
<li>Persistent Data Volumes</li>
<li>nginx<ul>
<li>nginx + lets encrypt ssl certificates</li>
<li>nginx static content</li>
<li>nginx bind-mounted files</li>
</ul>
</li>
<li>mysql</li>
<li>mediawiki<ul>
<li>mediawiki data volume</li>
<li>mediawiki bind-mounted files</li>
</ul>
</li>
<li>gitea<ul>
<li>gitea data volume</li>
<li>gitea bind-mounted files</li>
</ul>
</li>
<li>python file server (pyfiles)<ul>
<li>pyfiles directory</li>
</ul>
</li>
</ul>
<h2 id="backups">Backups<a class="headerlink" href="#backups" title="Permanent link">&para;</a></h2>
<p>There are a number of directories containing utility scripts - these are mostly 
dedicated to creating backups of any non-version-controlled data inside the container.</p>
<p>See <strong><a href="Backups/">Backups.md</a></strong> for coverage of backup and utility scripts.</p>
<p><code>utils-backups</code> - backup utilities (for cron jobs)</p>
<p><code>utils-mw</code> - mediawiki backup utilities</p>
<p><code>utils-mysql</code> mysql backup utilities</p>
<h2 id="domains-and-ports">Domains and Ports<a class="headerlink" href="#domains-and-ports" title="Permanent link">&para;</a></h2>
<p>See <strong><a href="Ports/">Domains and Ports.md</a></strong> for info about top-level domain names
and ports used by this docker pod.</p>
<p>The domains ports document covers:</p>
<ul>
<li>Domains<ul>
<li>nginx domain handling</li>
</ul>
</li>
<li>Ports<ul>
<li>nginx ports</li>
<li>mediawiki/apache ports</li>
<li>phpmyadmin ports</li>
<li>mysql ports</li>
<li>gitea ports</li>
<li>python file server ports</li>
</ul>
</li>
</ul>
<h3 id="additional-port-info">Additional Port Info<a class="headerlink" href="#additional-port-info" title="Permanent link">&para;</a></h3>
<p>The apache-mediawiki combination is running an apache service listening on port 8989.
This can be adjusted, but should be adjusted in the Dockerfile, <code>ports.conf</code>, and <code>wiki.conf</code>.</p>
<p>The apache service listens on all interfaces (hence <code>*:8989</code> in the apache conf file),
but there is no port mapping specified in <code>docker-compose.yml</code> so it does not listen 
on any public interfaces.</p>
<p>Thus, the wiki is not publicly accessible via port 8989, but the wiki is available via port 8989
to any container linked to, or connected to the same network as, the mediawiki apache container.</p>
<p>Meanwhile, the nginx container has a public interface listening on port 80 
and another listening on port 443. nginx listens for requests going to
the wiki, detected via the url resource prefix being <code>/w/</code> or <code>/wiki/</code>,
and acts as a reverse proxy, forwarding the requests to Apache.</p>
<p>The user transparently sees everything happening via port 80 or (preferrably) 443,
but on the backend nginx is passing along the URL request and returning the result.</p>
<p>Subdomains are served via reverse proxy on port 7777+. </p>
<p>The webhook server is a flask server listening on port 50000.</p>
<h2 id="secrets">Secrets<a class="headerlink" href="#secrets" title="Permanent link">&para;</a></h2>
<p>See <strong><a href="Secrets/">Secrets.md</a></strong> for more info about getting secrets like 
passwords and sensitive files into various containers in the pod.</p>
<p>The important bit: we use <code>root.password</code> to store the password, and pass it
into containers as an environment variable. Only this top-level pod-charlesreid1
repo should use the file <code>root.password</code>.</p>
<p>Details covered on the secrets page:</p>
<ul>
<li>mysql database root password</li>
<li>mediawiki mysql database root password</li>
<li>gitea secret key and session id</li>
<li>nginx ssl certificates</li>
</ul>
<h2 id="container-specific-configuration-details">Container-Specific Configuration Details<a class="headerlink" href="#container-specific-configuration-details" title="Permanent link">&para;</a></h2>
<p>Each container has a different way of getting
configuration files into the container.
In the following documents we cover 
the specifics of each container.</p>
<ul>
<li><a href="Service_mediawiki/">mediawiki</a></li>
<li><a href="Service_apachephp/">apache + php</a></li>
<li><a href="Service_mysql/">mysql</a></li>
<li><a href="Service_phpmyadmin/">phpmyadmin</a> </li>
<li><a href="Service_nginx/">nginx + ssl</a></li>
<li><a href="Service_pythonfiles/">python</a></li>
<li><a href="Service_gitea/">gitea</a></li>
</ul>
<h2 id="links_1">Links<a class="headerlink" href="#links_1" title="Permanent link">&para;</a></h2>
<p>docker compose documentation:</p>
<ul>
<li><a href="https://docs.docker.com/compose/gettingstarted/#step-4-build-and-run-your-app-with-compose">getting started</a></li>
<li><a href="https://docs.docker.com/compose/environment-variables/#set-environment-variables-in-containers">set environment variables in containers</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="Service_mediawiki/" title="Pod Service: MediaWiki" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Pod Service: MediaWiki
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 <a href="https://charlesreid1.com">Charles Reid</a>, released under the <a href="https://opensource.org/licenses/MIT">MIT license</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.e72fd936.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
        <script src="search/main.js"></script>
      
    
    
      
    
  </body>
</html>